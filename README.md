# sqlcodegen

Generate Go structs from SQL string literals.

Currently supports only PostgreSQL.

## Usage

1. Run init to generate sqlcodegen.yml

```
go run github.com/mtsmfm/sqlcodegen init
```

2. Write a code which runs SQL with plain string literal

```golang
var results []interface{}
err = db.Select(&results, "SELECT id FROM users")
```

3. Run generate command

```
export DATABASE_URL=postgres://user:password@postgres/db?sslmode=disable
go run github.com/mtsmfm/sqlcodegen generate
```

Above command generates:

```golang
// Code generated by sqlcodegen, DO NOT EDIT.

package sqlstructs

/*
	SELECT id FROM users LIMIT 5
*/
type IdInt struct {
	Id int `db:"id" json:"id"`
}
```

4. Use struct

```golang
var results []sqlstruct.IdInt
err = db.Select(&results, "SELECT id FROM users")
```

### Specify struct name

You can specify struct name via comment.
Write `// sqlcodegen:name <struct name>` just before the string literal:

```golang
// sqlcodegen:name Foo
err = db.Select(&results, "SELECT id FROM users")
```

Generated code will be:

```golang
// Code generated by sqlcodegen, DO NOT EDIT.

package sqlstructs

/*
	SELECT id FROM users LIMIT 5
*/
type Foo struct {
	Id int `db:"id" json:"id"`
}
```

## TODOs

- Support MySQL
- Add more default typemap
